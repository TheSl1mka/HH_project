<center> <img src = https://raw.githubusercontent.com/AndreyRysistov/DatasetsForPandas/main/hh%20label.jpg alt="drawing" style="width:400px;"> </center>

# <center> Проект: Анализ резюме из HeadHunter </center>

# Содержание проекта:

## 1. Исследование структуры данных
### 1.1. Чтение данных с помощью библиотеки Pandas.
[Скачать датасет можно здесь](https://drive.google.com/file/d/1JtfoU1OO6TcPatcMKabdk3xYux7sWdJb/view?usp=sharing)
### 1.2. Ознакомление с признаками и их структурой.
### 1.3. Анализ информации о числе непустых значений в столбцах и их типах в таблице.
### 1.4. Анализ информации о числе непустых значений.
### 1.5. Изучение основной статистической информации о столбцах.

## 2. Преобразование данных
### 2.1. Преобразование признака 'Образование и ВУЗ'.
#### Формат до преобразования:
> <Уровень образования год выпуска ВУЗ специальность...>
#### Выделение уровня образования в новый признак 'Образование'.

### 2.2. Преобразование признака 'Пол, возраст'.
#### Формат до преобразования:
> <Пол , возраст, дата рождения>
#### Выделение пола и возраста в два новых признака 'Пол' и 'Возраст'.

### 2.3. Преобразование признака 'Опыт работы'.
#### Формат до преобразования:
> <Опыт работы: n лет m месяцев, периоды работы в различных компаниях…>
#### Выделение опыта работы в новый признак 'Опыт работы (месяц)'.

### 2.4. Преобразование признака 'Город, переезд, командировки'.
#### Формат до преобразования:
> <Город , (метро) , готовность к переезду (города для переезда) , готовность к командировкам>
#### Распределение информации по новым признакам 'Город', 'Готовность к переезду' и 'Готовность к командировкам'.
#### Формат признака 'Город' после преобразования:
> «Москва», «Санкт-Петербург», «город-миллионник» и «другие»
#### Список городов-милионников:
```python
million_cities = ['Новосибирск', 'Екатеринбург', 'Нижний Новгород', 'Казань', 'Челябинск', 'Омск', 'Самара', 'Ростов-на-Дону', 'Уфа', 'Красноярск', 'Пермь', 'Воронеж', 'Волгоград']
```
#### Формат признаков 'Готовность к переезду' и 'Готовность к командировкам' после преобразования:
> True, False

### 2.5. Преобразование признаков 'Занятость' и 'График'.
#### Формат до преобразования:
> полная занятость, частичная занятость;

> частичная занятость, проектная работа, волонтёрство;

> полный день, удалённая работа;

> вахтовый метод, гибкий график, удалённая работа, полная занятость.
#### Cоздание признаков-«мигалок» для каждой категории: если категория присутствует в списке желаемых соискателем, то в столбце на месте строки рассматриваемого соискателя ставится True, иначе — False. Такой метод преобразования категориальных признаков называется One Hot Encoding.

<center> <img src=images/dst-3.0_16_3_1.png width=650 height=325> </center>

### 2.6. Преобразование признака 'ЗП'.
#### Формат до преобразования:
> 30 000 руб.;

> 50 000 грн.;

> 550 USD.

#### Преобразование желаемой зарплаты в рубли по курсу на дату обновления резюме (дата получена из признана 'Обновление резюме') в новый признак 'ЗП (руб)'.
[Скачать данные о курсах валют можно здесь](https://drive.google.com/file/d/1Ar-pKgVngxW1ThskpGyFYQfTFme8oWkV/view?usp=sharing)

## 3. Исследование зависимостей в данных

### Проведен разведывательный анализ (EDA), проанализировано:
* распределение признака 'Возраст';
* распределение признака 'Опыт работы (месяц)';
* распределение признака 'ЗП (руб)';
* зависимость медианной желаемой заработной платы ('ЗП (руб)') от уровня образования ('Образование');
* распределение желаемой заработной платы ('ЗП (руб)') в зависимости от города ('Город');
* зависимость медианной заработной платы ('ЗП (руб)') от признаков 'Готовность к переезду' и 'Готовность к командировкам';
* зависимость медианной желаемой заработной платы от возраста ('Возраст') и образования ('Образование');
* зависимость опыта работы ('Опыт работы (месяц)') от возраста ('Возраст');
* зависимости медианной заработной платы от видов занятости и графика работы (признаки-«мигалки», получившиеся из признаков 'Занятость' и 'График');
* зависимости желаемой заработной платы ('ЗП (руб)') от пола соискателей ('Пол')

## 4. Очистка данных

### 4.1. Удалены дубликаты из данных.
```python
data = data.drop_duplicates(subset=list(data.columns))
```
### 4.2. Удалены или заполнены пропуски в данных.
```python
data = data.dropna(axis=0, how='any', subset=['Последнее/нынешнее место работы', 'Последняя/нынешняя должность'])

data = data.fillna({'Опыт работы (месяц)': data['Опыт работы (месяц)'].median()})
```
### 4.3. Удалены аномалии (выбросы) в данных.
* заработная плата либо выше 1 миллиона рублей, либо ниже 1 тысячи рублей
```python
outliers = data[(data['ЗП (руб)'] > 1000000) | (data['ЗП (руб)'] < 1000)].index

data = data.drop(outliers, axis=0)
```
* опыт работы в годах превышает возраст соискателя
```python
outliers = data[data['Опыт работы (месяц)'] / 12 > data['Возраст']].index

data = data.drop(outliers, axis=0)
```
* возраст, не подходящий для поиска работы

Проанализировано распределение признака 'Возраст' в логарифмическом масштабе. Найдены выбросы с помощью метода z-отклонения.

## Метод z-отклонений (метод сигм)

Правило трех сигм гласит: что, если распределение данных является нормальным, то 99.73% лежат в интервале: $(\mu-3 \sigma$ , $\mu+3 \sigma)$, 
где  
* $\mu$ - математическое ожидание (для выборки это среднее значение)
* $\sigma$ - стандартное отклонение. 

Наблюдения, которые лежат за пределами этого интервала будут считаться выбросами.

![](images/method_sigm.png)

### **Алгоритм метода:**

1. Вычислить среднее и стандартное отклонение $\mu$ и $\sigma$ для признака, который мы исследуем
2. Определить верхнюю и нижнюю границы:
    * $bound_{upper} = \mu - 3 * \sigma$
    
    * $bound_{lower} = \mu + 3 * \sigma$
3. Найти наблюдения, которые выходят за пределы границ

## Реализация алгоритма метода

```python
#функция реализации алгоритма метода z-отклонения для выявления выбросов
def outliers_z_score(data, feature, log_scale=False, left=3, right=3):
    if log_scale:
        x = np.log(data[feature])
    else:
        x = data[feature]
    mu = x.mean()
    sigma = x.std()
    lower_bound = mu - left * sigma
    upper_bound = mu + right * sigma
    outliers = data[(x < lower_bound) | (x > upper_bound)]
    cleaned = data[(x > lower_bound) & (x < upper_bound)]
    return outliers, cleaned

#пример применения в отношении признака 'Возраст', найдем выбросы с послаблением на 1 сигму правую сторону
outliers, data = outliers_z_score(data, 'Возраст', log_scale=True, left=3, right=4)
```

## Использованные инструменты и библиотеки
* numpy (1.23.4)
* pandas (1.5.1)
* plotly (5.11.0)
* matplotlib (3.6.2)
* seaborn (0.12.1)
